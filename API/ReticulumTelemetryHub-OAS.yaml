openapi: 3.0.1
info:
  title: ReticulumTelemetryHub
  version: '2026.01.11'
  description: >-
    Abstract service for Reticulum Telemetry Hub. This API manages subscribers, topics, client lists, and provides hub join/leave functionality over a Reticulum-based network.
  contact:
    name: FTTeam
    url: https://github.com/FreeTAKTeam
    email: FreeTAKTeam@gmail.com
  license:
    name: EPL
paths:
  /Help:
    get:
      x-scope: public
      x-lxmf-command: Help
      tags:
       - Command
      summary: Return the list of supported commands.
      responses:
        '200':
          description: Markdown formatted command list.
          content:
            text/plain:
              schema:
                type: string
  /Examples:
    get:
      x-scope: public
      x-lxmf-command: Examples
      tags:
       - Command
      summary: Return command descriptions and JSON payload examples.
      responses:
        '200':
          description: Markdown formatted command examples.
          content:
            text/plain:
              schema:
                type: string
  /Status:
    get:
      x-scope: protected
      x-lxmf-command: GetStatus
      tags:
       - Status
      summary: Return dashboard status metrics.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Status snapshot for admin dashboards.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Status'
  /Events:
    get:
      x-scope: protected
      x-lxmf-command: ListEvents
      tags:
       - Status
      summary: Return recent hub events.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Recent event entries.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Event'
  /events/system:
    get:
      x-scope: protected
      x-websocket: true
      tags:
       - WebSocket
      summary: WebSocket stream for system status + events.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      description: >-
        WebSocket endpoint using the RTH-WS v1 envelope. See docs/ui-design.md.
      x-ws-protocol: rth-ws-v1
      x-ws-server-messages:
        - $ref: '#/components/schemas/WsAuthOkMessage'
        - $ref: '#/components/schemas/WsSystemStatusMessage'
        - $ref: '#/components/schemas/WsSystemEventMessage'
        - $ref: '#/components/schemas/WsPingMessage'
        - $ref: '#/components/schemas/WsErrorMessage'
      x-ws-client-messages:
        - $ref: '#/components/schemas/WsAuthMessage'
        - $ref: '#/components/schemas/WsPongMessage'
        - $ref: '#/components/schemas/WsSystemSubscribeMessage'
      responses:
        '101':
          description: Switching Protocols (WebSocket upgrade).
  /Telemetry:
    get:
      x-scope: public
      x-lxmf-command: TelemetryRequest
      tags:
       - Telemetry
      summary: Retrieve telemetry snapshots since a timestamp.
      parameters:
        - $ref: '#/components/parameters/telemetrySince'
        - $ref: '#/components/parameters/topicId'
      responses:
        '200':
          description: Telemetry stream entries.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelemetryResponse'
  /telemetry/stream:
    get:
      x-scope: public
      x-websocket: true
      tags:
       - WebSocket
      summary: WebSocket stream for live telemetry.
      description: >-
        WebSocket endpoint using the RTH-WS v1 envelope. See docs/ui-design.md.
      x-ws-protocol: rth-ws-v1
      x-ws-server-messages:
        - $ref: '#/components/schemas/WsAuthOkMessage'
        - $ref: '#/components/schemas/WsTelemetrySnapshotMessage'
        - $ref: '#/components/schemas/WsTelemetryUpdateMessage'
        - $ref: '#/components/schemas/WsPingMessage'
        - $ref: '#/components/schemas/WsErrorMessage'
      x-ws-client-messages:
        - $ref: '#/components/schemas/WsAuthMessage'
        - $ref: '#/components/schemas/WsTelemetrySubscribeMessage'
        - $ref: '#/components/schemas/WsPongMessage'
      responses:
        '101':
          description: Switching Protocols (WebSocket upgrade).
  /messages/stream:
    get:
      x-scope: protected
      x-websocket: true
      tags:
       - WebSocket
      summary: WebSocket stream for inbound/outbound messages.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      description: >-
        WebSocket endpoint using the RTH-WS v1 envelope. See docs/ui-design.md.
      x-ws-protocol: rth-ws-v1
      x-ws-server-messages:
        - $ref: '#/components/schemas/WsAuthOkMessage'
        - $ref: '#/components/schemas/WsMessageReceiveMessage'
        - $ref: '#/components/schemas/WsMessageSubscribedMessage'
        - $ref: '#/components/schemas/WsMessageSentMessage'
        - $ref: '#/components/schemas/WsPingMessage'
        - $ref: '#/components/schemas/WsErrorMessage'
      x-ws-client-messages:
        - $ref: '#/components/schemas/WsAuthMessage'
        - $ref: '#/components/schemas/WsMessageSubscribeMessage'
        - $ref: '#/components/schemas/WsMessageSendMessage'
        - $ref: '#/components/schemas/WsPongMessage'
      responses:
        '101':
          description: Switching Protocols (WebSocket upgrade).
  /Config:
    get:
      x-scope: protected
      x-lxmf-command: GetConfig
      tags:
       - Config
      summary: Return the raw config.ini content.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Config content.
          content:
            text/plain:
              schema:
                type: string
    put:
      x-scope: protected
      x-lxmf-command: ApplyConfig
      tags:
       - Config
      summary: Apply a new config.ini payload.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/ConfigPayload'
      responses:
        '200':
          description: Apply result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigApplyResult'
  /Config/Validate:
    post:
      x-scope: protected
      x-lxmf-command: ValidateConfig
      tags:
       - Config
      summary: Validate a config.ini payload without applying.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/ConfigPayload'
      responses:
        '200':
          description: Validation result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigValidation'
  /Config/Rollback:
    post:
      x-scope: protected
      x-lxmf-command: RollbackConfig
      tags:
       - Config
      summary: Roll back config.ini using a backup.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/ConfigRollback'
      responses:
        '200':
          description: Rollback result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigRollbackResult'
  /Command/FlushTelemetry:
    post:
      x-scope: protected
      x-lxmf-command: FlushTelemetry
      tags:
       - Command
      summary: Delete stored telemetry snapshots.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Deletion result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlushTelemetryResult'
  /Command/ReloadConfig:
    post:
      x-scope: protected
      x-lxmf-command: ReloadConfig
      tags:
       - Command
      summary: Reload config.ini from disk.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Reloaded configuration snapshot.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReticulumInfo'
  /Message:
    post:
      x-scope: protected
      tags:
       - Message
      summary: Send a message into the hub.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageRequest'
      responses:
        '200':
          description: Message dispatch acknowledgement.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageSendResult'
  /Command/DumpRouting:
    get:
      x-scope: protected
      x-lxmf-command: DumpRouting
      tags:
       - Command
      summary: Return connected destination hashes.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Routing summary.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoutingSummary'
  /Identities:
    get:
      x-scope: protected
      x-lxmf-command: ListIdentities
      tags:
       - Identity
      summary: List identity moderation status entries.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          description: Identity statuses.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/IdentityStatus'
  /Client/{id}/Ban:
    post:
      x-scope: protected
      x-lxmf-command: BanIdentity
      tags:
       - Identity
      summary: Ban an identity.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      parameters:
        - $ref: '#/components/parameters/identityPath'
      responses:
        '200':
          description: Updated identity status.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentityStatus'
  /Client/{id}/Unban:
    post:
      x-scope: protected
      x-lxmf-command: UnbanIdentity
      tags:
       - Identity
      summary: Remove ban/blackhole for an identity.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      parameters:
        - $ref: '#/components/parameters/identityPath'
      responses:
        '200':
          description: Updated identity status.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentityStatus'
  /Client/{id}/Blackhole:
    post:
      x-scope: protected
      x-lxmf-command: BlackholeIdentity
      tags:
       - Identity
      summary: Blackhole an identity.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      parameters:
        - $ref: '#/components/parameters/identityPath'
      responses:
        '200':
          description: Updated identity status.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentityStatus'
  /RTH:
    post:
      x-scope: public
      x-lxmf-command: join
      tags:
       - RTH
      description: >-
        Join an RTH instance as the supplied identity.
      operationId: RTHjoin
      parameters:
        - $ref: '#/components/parameters/identity'
      responses:
        '200':
          description: True when the identity is recorded or updated.
          content:
            application/json:
              schema:
                type: boolean
    put:
      x-scope: public
      x-lxmf-command: leave
      tags:
       - RTH
      description: >-
        Leave an RTH instance as the supplied identity.
      operationId: RTHLeave
      parameters:
        - $ref: '#/components/parameters/identity'
      responses:
        '200':
          description: True when the identity existed and was removed.
          content:
            application/json:
              schema:
                type: boolean
  /Topic/{id}:
    get:
      x-scope: public
      x-lxmf-command: RetrieveTopic
      tags:
       - Topic
      description: >-
      summary: retrieve an existing Topic record based on the provided ID.
      operationId: RetrieveTopic
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: Topic record.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Topic'
  /Client:
    get:
      x-scope: protected
      x-lxmf-command: ListClients
      tags:
       - Client
      description: >-
        Lists all clients currently connected to RTH, including their Reticulum identities and connection metadata
      operationId: ListClients
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          $ref: '#/components/responses/200Client_get'
  /api/v1/app/info:
    get:
      x-scope: public
      x-lxmf-command: getAppInfo
      tags:
       - Reticulum
      description: >-
        returns the configured application metadata and component versions
      operationId: getAppInfo
      responses:
        '200':
          description: Application info including Reticulum and LXMF versions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReticulumInfo'
  /File:
    get:
      x-scope: public
      x-lxmf-command: ListFiles
      tags:
       - File
      summary: List stored file attachments.
      operationId: ListFiles
      responses:
        '200':
          description: Stored file metadata (includes TopicID when tagged via the upload command or AssociateTopicID).
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FileAttachment'
  /File/{id}:
    get:
      x-scope: public
      x-lxmf-command: RetrieveFile
      tags:
       - File
      summary: Retrieve a stored file by its ID.
      operationId: RetrieveFile
      parameters:
        - $ref: '#/components/parameters/fileId'
      responses:
        '200':
          description: Stored file metadata (binary delivered via LXMF fields for LXMF clients).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileAttachment'
  /File/{id}/raw:
    get:
      x-scope: public
      x-lxmf-command: RetrieveFile
      tags:
       - File
      summary: Download a stored file by its ID (raw bytes).
      operationId: RetrieveFileRaw
      parameters:
        - $ref: '#/components/parameters/fileId'
      responses:
        '200':
          description: Raw file bytes.
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
  /Image:
    get:
      x-scope: public
      x-lxmf-command: ListImages
      tags:
       - Image
      summary: List stored images.
      operationId: ListImages
      responses:
        '200':
          description: Stored image metadata (includes TopicID when tagged via the upload command or AssociateTopicID).
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FileAttachment'
  /Image/{id}:
    get:
      x-scope: public
      x-lxmf-command: RetrieveImage
      tags:
       - Image
      summary: Retrieve a stored image by its ID.
      operationId: RetrieveImage
      parameters:
        - $ref: '#/components/parameters/fileId'
      responses:
        '200':
          description: Stored image metadata (binary delivered via LXMF fields for LXMF clients).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileAttachment'
  /Image/{id}/raw:
    get:
      x-scope: public
      x-lxmf-command: RetrieveImage
      tags:
       - Image
      summary: Download a stored image by its ID (raw bytes).
      operationId: RetrieveImageRaw
      parameters:
        - $ref: '#/components/parameters/fileId'
      responses:
        '200':
          description: Raw image bytes.
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
  /Topic:
    post:
      x-scope: protected
      x-lxmf-command: CreateTopic
      tags:
       - Topic
      description: >-
      summary: Creates a new Topic record.
      operationId: CreateTopic
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Topic'
      responses:
        '200':
          $ref: '#/components/responses/200Topic_post'
    delete:
      x-scope: protected
      x-lxmf-command: DeleteTopic
      tags:
       - Topic
      description: >-
      summary: Deletes an existing Topic record based on the provided ID.
      operationId: DeleteTopic
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      parameters:
        - $ref: '#/components/parameters/ID'
      responses:
        '200':
          $ref: '#/components/responses/200Topic_delete'
    get:
      x-scope: public
      x-lxmf-command: ListTopic
      tags:
       - Topic
      description: >-
      summary: Retrieves a list of all Topic
      operationId: ListTopic
      responses:
        '200':
          $ref: '#/components/responses/200Topic_get'
    patch:
      x-scope: protected
      x-lxmf-command: PatchTopic
      tags:
       - Topic
      description: >-
      summary: Updates an existing Topic record.
      operationId: PatchTopic
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Topic'
      responses:
        '200':
          $ref: '#/components/responses/200Topic_patch'
  /Topic/Subscribe:
    post:
      x-scope: public
      x-lxmf-command: SubscribeTopic
      tags:
       - Topic
      description: >-
        Subscribe a destination to a topic (Destination defaults to the authenticated identity when omitted).
      operationId: SubscribeTopic
      requestBody:
        $ref: '#/components/requestBodies/SubscribeTopicRequest'
      responses:
        '200':
          description: Subscriber record for the subscription.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscriber'
  /Topic/Associate:
    post:
      x-scope: protected
      x-lxmf-command: AssociateTopicID
      tags:
       - Topic
      summary: Associate an attachment upload with a TopicID.
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Topic'
      responses:
        '200':
          description: Association acknowledged.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Topic'
  /Subscriber/{id}:
    get:
      x-scope: protected
      x-lxmf-command: RetrieveSubscriber
      tags:
       - Subscriber
      description: >-
      summary: retrieve an existing Subscriber record based on the provided ID.
      operationId: RetrieveSubscriber
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: Subscriber record.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscriber'
  /Subscriber/Add:
    post:
      x-scope: protected
      x-lxmf-command: AddSubscriber
      tags:
       - Subscriber
      description: >-
      summary: Add a destination/topic subscriber mapping (admin).
      operationId: AddSubscriber
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Subscriber'
      responses:
        '200':
          description: Subscriber record.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscriber'
  /Subscriber:
    post:
      x-scope: protected
      x-lxmf-command: CreateSubscriber
      tags:
       - Subscriber
      description: >-
      summary: Creates a new Subscriber record.
      operationId: CreateSubscriber
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Subscriber'
      responses:
        '200':
          $ref: '#/components/responses/200Subscriber_post'
    delete:
      x-scope: protected
      x-lxmf-command: DeleteSubscriber
      tags:
       - Subscriber
      description: >-
      summary: Deletes an existing Subscriber record based on the provided ID.
      operationId: DeleteSubscriber
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      parameters:
        - $ref: '#/components/parameters/ID'
      responses:
        '200':
          $ref: '#/components/responses/200Subscriber_delete'
    get:
      x-scope: protected
      x-lxmf-command: ListSubscriber
      tags:
       - Subscriber
      description: >-
      summary: Retrieves a list of all Subscriber
      operationId: ListSubscriber
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      responses:
        '200':
          $ref: '#/components/responses/200Subscriber_get'
    patch:
      x-scope: protected
      x-lxmf-command: PatchSubscriber
      tags:
       - Subscriber
      description: >-
      summary: Updates an existing Subscriber record.
      operationId: PatchSubscriber
      security:
        - bearerAuth: []
        - apiKeyAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Subscriber'
      responses:
        '200':
          $ref: '#/components/responses/200Subscriber_patch'

components:
  schemas:
    Subscriber:
      type: object
      description: Subscription details linking destinations to topics.
      properties:
        SubscriberID:
          type: string
          nullable: true
          description: Unique identifier for the subscriber mapping.
        Destination:
          type: string
          description: Destination hash (hex string).
        TopicID:
          type: string
          nullable: true
          description: Topic identifier for the subscription.
        RejectTests:
          type: integer
          nullable: true
          description: Optional reject-tests flag (0/1) or numeric mode.
        Metadata:
          type: object
          nullable: true
          additionalProperties: true
          description: Optional subscriber metadata.
      required:
        - Destination
    Topic:
      type: object
      description: Topic subscription metadata.
      properties:
        TopicID:
          type: string
          nullable: true
          description: Unique topic identifier.
        TopicName:
          type: string
          description: Human friendly topic name.
        TopicPath:
          type: string
          description: Stable topic path (used by clients for routing).
        TopicDescription:
          type: string
          description: Optional topic description.
      required:
        - TopicName
        - TopicPath
    FileAttachment:
      type: object
      description: Metadata for a stored file or image attachment.
      properties:
        FileID:
          type: integer
          description: Numeric identifier assigned by the hub.
        Name:
          type: string
          description: Attachment display name.
        Path:
          type: string
          description: Filesystem path where the attachment is stored.
        Category:
          type: string
          description: Attachment category ("file" or "image").
        MediaType:
          type: string
          nullable: true
          description: MIME type when provided.
        TopicID:
          type: string
          nullable: true
          description: Optional topic identifier associated with the attachment.
        Size:
          type: integer
          description: Attachment size in bytes.
        CreatedAt:
          type: string
          format: date-time
          description: When the attachment metadata was created.
        UpdatedAt:
          type: string
          format: date-time
          description: When the attachment metadata was last updated.
    Client:
      type: object
      description: Connected client state and metadata.
      properties:
        identity:
          type: string
          description: Client identity hash (hex string).
        last_seen:
          type: string
          format: date-time
          description: Last seen timestamp (UTC RFC3339).
        metadata:
          type: object
          additionalProperties: true
          description: Optional client metadata.
      required:
        - identity
        - last_seen
    Error:
      type: object
      description: Error response payload.
      properties:
        detail:
          type: string
          description: Human-readable error message.
        errors:
          type: array
          items:
            type: string
          description: Optional list of validation errors.
      additionalProperties: true
    ReticulumInfo:
      type: object
      description: Summarizes the  Reticulum node and application configuration.
      properties:
        is_transport_enabled:
          type: boolean
          description: Indicates whether Reticulum transport mode is enabled.
        is_connected_to_shared_instance:
          type: boolean
          description: True when the node is linked to a shared Reticulum instance.
        reticulum_config_path:
          type: string
          description: Filesystem path to the Reticulum configuration.
        database_path:
          type: string
          description: Filesystem path to the Reticulum database.
        storage_path:
          type: string
          description: Root path where Reticulum stores persistent data.
        file_storage_path:
          type: string
          description: Folder where file attachments are stored (defaults to ``<storage_dir>/files``).
        image_storage_path:
          type: string
          description: Folder where image artifacts are stored (defaults to ``<storage_dir>/images``).
        app_name:
          type: string
          description: Application display name configured in ``config.ini``.
        rns_version:
          type: string
          description: Installed Reticulum (RNS) version string.
        lxmf_version:
          type: string
          description: Installed LXMF library version.
        app_version:
          type: string
          description: Version of the Reticulum Telemetry Hub application.
        app_description:
          type: string
          description: Human readable description for the Telemetry Hub.
    Status:
      type: object
      description: Dashboard status snapshot.
      properties:
        uptime_seconds:
          type: integer
        clients:
          type: integer
        topics:
          type: integer
        subscribers:
          type: integer
        files:
          type: integer
        images:
          type: integer
        telemetry:
          $ref: '#/components/schemas/TelemetryStats'
    TelemetryStats:
      type: object
      description: Telemetry ingestion counters.
      properties:
        ingest_count:
          type: integer
        last_ingest_at:
          type: string
          nullable: true
    Event:
      type: object
      description: Recent event entry.
      properties:
        timestamp:
          type: string
        type:
          type: string
        message:
          type: string
        metadata:
          type: object
    MessageEntry:
      type: object
      description: Inbound LXMF message entry.
      properties:
        timestamp:
          type: string
        source:
          type: string
        source_hash:
          type: string
        topic_id:
          type: string
          nullable: true
        content:
          type: string
    MessageRequest:
      type: object
      description: Message payload for dispatching to the hub.
      required:
        - Content
      properties:
        Content:
          type: string
        TopicID:
          type: string
          nullable: true
        Destination:
          type: string
          nullable: true
    MessageSendResult:
      type: object
      description: Message dispatch acknowledgement.
      properties:
        sent:
          type: boolean
    TelemetryResponse:
      type: object
      description: Telemetry stream response payload.
      properties:
        entries:
          type: array
          items:
            $ref: '#/components/schemas/TelemetryEntry'
    TelemetryEntry:
      type: object
      properties:
        peer_destination:
          type: string
        timestamp:
          type: integer
        telemetry:
          type: object
    IdentityStatus:
      type: object
      description: Identity moderation status.
      properties:
        Identity:
          type: string
        Status:
          type: string
        LastSeen:
          type: string
          nullable: true
        Metadata:
          type: object
        IsBanned:
          type: boolean
        IsBlackholed:
          type: boolean
    ConfigValidation:
      type: object
      properties:
        valid:
          type: boolean
        errors:
          type: array
          items:
            type: string
    ConfigApplyResult:
      type: object
      properties:
        applied:
          type: boolean
        config_path:
          type: string
        backup_path:
          type: string
          nullable: true
    ConfigRollbackResult:
      type: object
      properties:
        rolled_back:
          type: boolean
        backup_path:
          type: string
          nullable: true
        error:
          type: string
          nullable: true
    FlushTelemetryResult:
      type: object
      properties:
        deleted:
          type: integer
    RoutingSummary:
      type: object
      properties:
        destinations:
          type: array
          items:
            type: string
    SubscribeTopicRequest:
      type: object
      description: Payload for SubscribeTopic (topic subscription request).
      properties:
        TopicID:
          type: string
          description: Topic identifier to subscribe to.
        Destination:
          type: string
          nullable: true
          description: Destination hash to subscribe (defaults to authenticated identity when omitted).
        RejectTests:
          type: integer
          nullable: true
          description: Optional reject-tests flag (0/1) or numeric mode.
        Metadata:
          type: object
          nullable: true
          additionalProperties: true
          description: Optional subscriber metadata.
      required:
        - TopicID
    WsEnvelope:
      type: object
      description: RTH-WS v1 envelope.
      properties:
        type:
          type: string
        ts:
          type: string
          format: date-time
        data:
          type: object
      required:
        - type
        - ts
        - data
    WsAuthMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [auth]
            data:
              type: object
              properties:
                token:
                  type: string
                  nullable: true
                api_key:
                  type: string
                  nullable: true
              additionalProperties: false
    WsSystemSubscribeMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [system.subscribe]
            data:
              type: object
              properties:
                include_status:
                  type: boolean
                include_events:
                  type: boolean
                events_limit:
                  type: integer
              additionalProperties: false
    WsAuthOkMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [auth.ok]
            data:
              type: object
              additionalProperties: true
    WsErrorMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [error]
            data:
              type: object
              properties:
                code:
                  type: string
                message:
                  type: string
              additionalProperties: true
    WsPingMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [ping]
            data:
              type: object
              properties:
                nonce:
                  type: string
              additionalProperties: false
    WsPongMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [pong]
            data:
              type: object
              properties:
                nonce:
                  type: string
              additionalProperties: false
    WsSystemStatusMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [system.status]
            data:
              $ref: '#/components/schemas/Status'
    WsSystemEventMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [system.event]
            data:
              $ref: '#/components/schemas/Event'
    WsTelemetrySubscribeMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [telemetry.subscribe]
            data:
              type: object
              required:
                - since
              properties:
                since:
                  type: integer
                topic_id:
                  type: string
                  nullable: true
                follow:
                  type: boolean
              additionalProperties: false
    WsTelemetrySnapshotMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [telemetry.snapshot]
            data:
              type: object
              properties:
                entries:
                  type: array
                  items:
                    $ref: '#/components/schemas/TelemetryEntry'
              additionalProperties: false
    WsTelemetryUpdateMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [telemetry.update]
            data:
              type: object
              properties:
                entry:
                  $ref: '#/components/schemas/TelemetryEntry'
              additionalProperties: false
    WsMessageSubscribeMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [message.subscribe]
            data:
              type: object
              properties:
                topic_id:
                  type: string
                  nullable: true
                source_hash:
                  type: string
                  nullable: true
                follow:
                  type: boolean
              additionalProperties: false
    WsMessageSubscribedMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [message.subscribed]
            data:
              type: object
              properties:
                topic_id:
                  type: string
                  nullable: true
                source_hash:
                  type: string
                  nullable: true
                follow:
                  type: boolean
              additionalProperties: false
    WsMessageSendMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [message.send]
            data:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                topic_id:
                  type: string
                  nullable: true
                destination:
                  type: string
                  nullable: true
              additionalProperties: false
    WsMessageSentMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [message.sent]
            data:
              type: object
              properties:
                ok:
                  type: boolean
              additionalProperties: false
    WsMessageReceiveMessage:
      allOf:
        - $ref: '#/components/schemas/WsEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum: [message.receive]
            data:
              type: object
              properties:
                entry:
                  $ref: '#/components/schemas/MessageEntry'
              additionalProperties: false
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    apiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
  parameters:
    identity:
      name: identity
      required: true
      description: >-
        Reticulum identity string (usually a hex destination hash) to act on.
      schema:
        type: string
      in: query
    ID:
      name: id
      required: true
      description: >-
        Record identifier (for example TopicID or SubscriberID).
      schema:
        type: string
      in: query
    id:
      name: id
      required: true
      description: >-
        Record identifier (path parameter).
      schema:
        type: string
      in: path
    fileId:
      name: id
      required: true
      description: Numeric identifier for a stored file or image.
      schema:
        type: integer
      in: path
    telemetrySince:
      name: since
      required: true
      description: Unix timestamp (seconds) to start telemetry snapshots from.
      schema:
        type: integer
      in: query
    topicId:
      name: topic_id
      required: false
      description: Optional topic identifier to scope telemetry results.
      schema:
        type: string
      in: query
    identityPath:
      name: id
      required: true
      description: Identity hash to modify.
      schema:
        type: string
      in: path
  responses:
    200Topic_get:
      description: Topic list.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Topic'
    200Client_get:
      description: Client list.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Client'
    200Topic_post:
      description: Success
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Topic'
    200Topic_delete:
      description: Success
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Topic'
    200Topic_patch:
      description: Success
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Topic'
    200Subscriber_get:
      description: Subscriber list.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Subscriber'
    200Subscriber_post:
      description: Success
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Subscriber'
    200Subscriber_delete:
      description: Success
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Subscriber'
    200Subscriber_patch:
      description: Success
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Subscriber'
    '200':
      description: OK
    '201':
      description: Added Object
    '202':
      description: Accepted
    '204':
      description: Deleted
    '400':
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '401':
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '403':
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '404':
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '405':
      description: Method Not allowed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '409':
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '500':
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '501':
      description: Not Implemented
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    '503':
      description: Service Unavailable
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    'Error':
      description: Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
  requestBodies:
    Subscriber:
      description: >-
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Subscriber'
      required: true
    Topic:
      description: >-
        a topic is an argument that can be subscribe to receive notifications
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Topic'
      required: true
    SubscribeTopicRequest:
      description: SubscribeTopic request payload.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SubscribeTopicRequest'
      required: true
    ConfigPayload:
      description: Raw config.ini payload.
      content:
        text/plain:
          schema:
            type: string
      required: true
    ConfigRollback:
      description: Optional rollback payload specifying a backup path.
      content:
        application/json:
          schema:
            type: object
            properties:
              backup_path:
                type: string
      required: false
x-uml-relationships:
  
